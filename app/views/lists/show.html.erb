<%= content_for :title, @list.name %>
<%= form_tag v0_list_url(@list, host: api_domain, subdomain: api_subdomain), remote: true, method: :get, class: "js-lists-api-form js-list-form" do %>
<% end %>
<div class="row nmhxs">
  <div class="col-md-8 phxs mtm">
    <div class="phm pbm ptxs bg-15 bss bwas bc-12">
      <div class="row nmhxs">
        <div class="col-sm-9 phxs mtxs">
          <div class="fsm">
            <%= @list.name %>
          </div>
        </div>
        <div class="col-sm-3 phxs mtxs text-right-sm">
          <div class="fss">
            <i class="fa fa-twitter fa-fw pointer"></i>
            <i class="fa fa-facebook fa-fw pointer"></i>
          </div>
        </div>
      </div>
    </div>
    <div class="pam mtxs bg-15 bss bwas bc-12">
      <div class="js-list-items">
        <% @list.items.each do |item| %>
          <div class="ptxs-plus nmtxs mtm-plus bss bwts-plus bc-12 js-list-item" data-id="<%= item.id %>">
            <div class="row nmhxs">
              <div class="col-sm-3 phxs mtxs">
                <div class="relative paxxxs bss bwas bc-12">
                  <%= image_tag item.product.image.url(:profile), class: "img-responsive" %>
                  <div class="absolute top left right nmhxxs nmtxxs fsxs ribbon bg-4 c-15 text-center">
                    <table class="mha">
                      <tr>
                        <td>
                          #<%= item.rank + 1 %>
                        </td>
                        <td class="plxxxs c-10 fsxxxs">
                          [ <span class="js-likes-count" data-likable="ListItem-<%= item.id %>"><%= item.likes_count %></span> ]
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
              <div class="col-sm-7 phxs mtxs">
                <div class="fwl">
                  <%= item.product.name %>
                </div>
                <div class="fws">
                  <%= item.product.manufacturer %>
                </div>
                <div class="fsxxxs fws c-blue">
                  [ <%= item.user.username %> ]
                </div>
              </div>
              <div class="col-sm-2 phxs">
                <div class="row nmhxxxs">
                  <div class="col-sm-6 phxxxs">
                    <%= link_to item.product.url do %>
                      <div class="phxxs pvxxxs mtxs bg-1 c-15 fsxxxs text-center">
                        <table class="mha">
                          <tr>
                            <td>
                              <i class="fa fa-dollar"></i>
                            </td>
                            <td class="visible-xs">
                              &nbsp;Purchase
                            </td>
                          </tr>
                        </table>
                      </div>
                    <% end %>
                  </div>
                  <div class="col-sm-6 phxxxs">
                    <div class="<%= "active " if current_or_guest_user.likes?(item) %>js-like">
                      <div class="hide-active">
                        <%= form_tag like_v0_user_url(host: api_domain, subdomain: api_subdomain), remote: true, class: "js-lists-api-form js-likes-form-like js-list-items-like" do %>
                          <%= hidden_field_tag :likable_type, "ListItem" %>
                          <%= hidden_field_tag :likable_id, item.id %>
                          <div class="phxxs pvxxxs mtxs bg-1 c-15 fsxxxs text-center pointer js-lists-api-form-submit">
                            <table class="mha">
                              <tr>
                                <td>
                                  <i class="fa fa-thumbs-up"></i>
                                </td>
                                <td class="visible-xs">
                                  &nbsp;Like
                                </td>
                              </tr>
                            </table>
                          </div>
                        <% end %>
                      </div>
                      <div class="show-active">
                        <%= form_tag unlike_v0_user_url(host: api_domain, subdomain: api_subdomain), remote: true, class: "js-lists-api-form js-likes-form-unlike js-list-items-like" do %>
                          <%= hidden_field_tag :likable_type, "ListItem" %>
                          <%= hidden_field_tag :likable_id, item.id %>
                          <div class="phxxs pvxxxs mtxs bg-8 c-15 fsxxxs text-center pointer js-lists-api-form-submit">
                            <table class="mha">
                              <tr>
                                <td>
                                  <i class="fa fa-thumbs-down"></i>
                                </td>
                                <td class="visible-xs">
                                  &nbsp;Unlike
                                </td>
                              </tr>
                            </table>
                          </div>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <% if current_user %>
      <div class="phm pbm ptxs mtxs bg-15 bss bwas bc-12">
        <div class="fss">
          Add Product
        </div>
        <div class="mtxs ptxs bss bwts bc-12">
          <%= form_tag v0_products_url(host: api_domain, subdomain: api_subdomain), remote: true, class: "js-lists-api-form js-products-form-new" do %>
            <%= hidden_field_tag :type, "AmazonProduct" %>
            <%= hidden_field_tag :id, nil %>
            <div class="mtm-plus">
              <div class="fsxxs">
                <%= label_tag :sku %>
              </div>
              <div class="fsxs">
                <%= text_field_tag :sku, nil, class: "paxxxs bss bwas bc-8 full-width" %>
                <div class="c-red hide js-lists-api-form-error" data-input-name="product[sku]"></div>
              </div>
            </div>
          <% end %>
          <%= form_tag add_product_v0_list_url(host: api_domain, subdomain: api_subdomain), remote: true, class: "js-lists-api-form js-admin-lists-form-add-product" do %>
            <%= hidden_field_tag :id, @list.id %>
            <%= hidden_field_tag :user_id, current_user.id %>
            <%= hidden_field_tag :product_id, nil, data: { dependent: true, dependent_on_form: ".js-products-form-new", dependent_on_input: "id" } %>
            <div class="mtm">
              <%= submit_tag "Create", class: "paxxxs bg-4 bg-2-hover c-14 c-15-hover full-width", data: { disable_with: "Creating" } %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
  <div class="col-md-4 phxs mtm">
    <div class="paxs bg-15 bss bwas bc-12">
      html
    </div>
  </div>
</div>
